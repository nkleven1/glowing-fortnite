<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Circular Restricted Three Body Problem | Noah‚Äôs Engineering Blog</title>
<meta name="keywords" content="">
<meta name="description" content="üõ∞Ô∏è Circular Restricted Three Body Problem
EP 471 ‚Äî Project Summary
This project explores how small disturbances in launch angle and velocity affect a single Moon flyby and return to Earth orbit.
The orbit is simulated numerically using a Backward Differentiation Formula (BDF) ‚Äî chosen because other methods become unstable when trajectories pass near the Moon.
The system is modeled using the Circular Restricted Three Body Problem (CR3BP) approximation.

Methodology
The numerical simulation:">
<meta name="author" content="">
<link rel="canonical" href="https://noahkleven.com/posts/cr3bp_post/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.2211ca3164be7830024f6aad2b3a2e520843a64f8f048445c3401c1249aa051d.css" integrity="sha256-IhHKMWS&#43;eDACT2qtKzouUghDpk&#43;PBIRFw0AcEkmqBR0=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://noahkleven.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://noahkleven.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://noahkleven.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://noahkleven.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://noahkleven.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://noahkleven.com/posts/cr3bp_post/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://noahkleven.com/posts/cr3bp_post/">
  <meta property="og:site_name" content="Noah‚Äôs Engineering Blog">
  <meta property="og:title" content="Circular Restricted Three Body Problem">
  <meta property="og:description" content="üõ∞Ô∏è Circular Restricted Three Body Problem EP 471 ‚Äî Project Summary This project explores how small disturbances in launch angle and velocity affect a single Moon flyby and return to Earth orbit.
The orbit is simulated numerically using a Backward Differentiation Formula (BDF) ‚Äî chosen because other methods become unstable when trajectories pass near the Moon.
The system is modeled using the Circular Restricted Three Body Problem (CR3BP) approximation.
Methodology The numerical simulation:">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-10-16T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-10-16T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Circular Restricted Three Body Problem">
<meta name="twitter:description" content="üõ∞Ô∏è Circular Restricted Three Body Problem
EP 471 ‚Äî Project Summary
This project explores how small disturbances in launch angle and velocity affect a single Moon flyby and return to Earth orbit.
The orbit is simulated numerically using a Backward Differentiation Formula (BDF) ‚Äî chosen because other methods become unstable when trajectories pass near the Moon.
The system is modeled using the Circular Restricted Three Body Problem (CR3BP) approximation.

Methodology
The numerical simulation:">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://noahkleven.com/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Circular Restricted Three Body Problem",
      "item": "https://noahkleven.com/posts/cr3bp_post/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Circular Restricted Three Body Problem",
  "name": "Circular Restricted Three Body Problem",
  "description": "üõ∞Ô∏è Circular Restricted Three Body Problem EP 471 ‚Äî Project Summary This project explores how small disturbances in launch angle and velocity affect a single Moon flyby and return to Earth orbit.\nThe orbit is simulated numerically using a Backward Differentiation Formula (BDF) ‚Äî chosen because other methods become unstable when trajectories pass near the Moon.\nThe system is modeled using the Circular Restricted Three Body Problem (CR3BP) approximation.\nMethodology The numerical simulation:\n",
  "keywords": [
    
  ],
  "articleBody": "üõ∞Ô∏è Circular Restricted Three Body Problem EP 471 ‚Äî Project Summary This project explores how small disturbances in launch angle and velocity affect a single Moon flyby and return to Earth orbit.\nThe orbit is simulated numerically using a Backward Differentiation Formula (BDF) ‚Äî chosen because other methods become unstable when trajectories pass near the Moon.\nThe system is modeled using the Circular Restricted Three Body Problem (CR3BP) approximation.\nMethodology The numerical simulation:\nIntegrates the motion of a spacecraft under Earth‚ÄìMoon gravity. Perturbs both initial velocity and launch angle to observe sensitivity. Uses stable numerical integration suitable for close-approach dynamics. Code Access You can view or download the full Python code here:\nüëâ CR3BP.py\nInput Parameters Parameter Description total_sample The total number of sample iterations. v_mag_nominal The nominal velocity magnitude at launch. phi_nominal The launch angle relative to Earth‚Äôs position from the Moon (counterclockwise orbit). phi_range The range of perturbation angle values the simulation will iterate over. vel_range The range of perturbation velocity values the simulation will iterate over. Output The simulation outputs trajectory data and plots illustrating how small variations in the initial conditions affect the resulting orbit.\nNotes This project demonstrates:\nThe sensitivity of orbital trajectories to small perturbations. The usefulness of implicit integration methods for close approaches. The practical application of the CR3BP in trajectory planning. ",
  "wordCount" : "219",
  "inLanguage": "en",
  "datePublished": "2025-10-16T00:00:00Z",
  "dateModified": "2025-10-16T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://noahkleven.com/posts/cr3bp_post/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Noah‚Äôs Engineering Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://noahkleven.com/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://noahkleven.com/" accesskey="h" title="Noah‚Äôs Engineering Blog (Alt + H)">Noah‚Äôs Engineering Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://noahkleven.com/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://noahkleven.com/archive/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://noahkleven.com/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://noahkleven.com/search/" title="Search">
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://noahkleven.com/">Home</a>&nbsp;¬ª&nbsp;<a href="https://noahkleven.com/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Circular Restricted Three Body Problem
    </h1>
    <div class="post-meta"><span title='2025-10-16 00:00:00 +0000 UTC'>October 16, 2025</span>&nbsp;¬∑&nbsp;2 min

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#-circular-restricted-three-body-problem" aria-label="üõ∞Ô∏è Circular Restricted Three Body Problem">üõ∞Ô∏è Circular Restricted Three Body Problem</a><ul>
                        <ul>
                        
                <li>
                    <a href="#ep-471--project-summary" aria-label="EP 471 ‚Äî Project Summary">EP 471 ‚Äî Project Summary</a></li>
                <li>
                    <a href="#methodology" aria-label="Methodology">Methodology</a></li>
                <li>
                    <a href="#code-access" aria-label="Code Access">Code Access</a></li>
                <li>
                    <a href="#input-parameters" aria-label="Input Parameters">Input Parameters</a></li>
                <li>
                    <a href="#output" aria-label="Output">Output</a></li>
                <li>
                    <a href="#notes" aria-label="Notes">Notes</a>
                </li>
            </ul>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="-circular-restricted-three-body-problem">üõ∞Ô∏è Circular Restricted Three Body Problem<a hidden class="anchor" aria-hidden="true" href="#-circular-restricted-three-body-problem">#</a></h1>
<h3 id="ep-471--project-summary">EP 471 ‚Äî Project Summary<a hidden class="anchor" aria-hidden="true" href="#ep-471--project-summary">#</a></h3>
<p>This project explores how <strong>small disturbances in launch angle and velocity</strong> affect a <strong>single Moon flyby and return to Earth orbit</strong>.<br>
The orbit is simulated numerically using a <strong>Backward Differentiation Formula (BDF)</strong> ‚Äî chosen because other methods become unstable when trajectories pass near the Moon.</p>
<p>The system is modeled using the <strong>Circular Restricted Three Body Problem (CR3BP)</strong> approximation.</p>
<hr>
<h3 id="methodology">Methodology<a hidden class="anchor" aria-hidden="true" href="#methodology">#</a></h3>
<p>The numerical simulation:</p>
<ul>
<li>Integrates the motion of a spacecraft under Earth‚ÄìMoon gravity.</li>
<li>Perturbs both <strong>initial velocity</strong> and <strong>launch angle</strong> to observe sensitivity.</li>
<li>Uses stable numerical integration suitable for close-approach dynamics.</li>
</ul>
<hr>
<h3 id="code-access">Code Access<a hidden class="anchor" aria-hidden="true" href="#code-access">#</a></h3>
<p>You can <strong>view or download</strong> the full Python code here:</p>
<p>üëâ <a href="/assets/code/CR3BP.py"><strong>CR3BP.py</strong></a></p>
<hr>
<h3 id="input-parameters">Input Parameters<a hidden class="anchor" aria-hidden="true" href="#input-parameters">#</a></h3>
<table>
  <thead>
      <tr>
          <th>Parameter</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>total_sample</code></td>
          <td>The total number of sample iterations.</td>
      </tr>
      <tr>
          <td><code>v_mag_nominal</code></td>
          <td>The nominal velocity magnitude at launch.</td>
      </tr>
      <tr>
          <td><code>phi_nominal</code></td>
          <td>The launch angle relative to Earth‚Äôs position from the Moon (counterclockwise orbit).</td>
      </tr>
      <tr>
          <td><code>phi_range</code></td>
          <td>The range of perturbation <strong>angle</strong> values the simulation will iterate over.</td>
      </tr>
      <tr>
          <td><code>vel_range</code></td>
          <td>The range of perturbation <strong>velocity</strong> values the simulation will iterate over.</td>
      </tr>
  </tbody>
</table>
<hr>
<h3 id="output">Output<a hidden class="anchor" aria-hidden="true" href="#output">#</a></h3>
<p>The simulation outputs trajectory data and plots illustrating how small variations in the initial conditions affect the resulting orbit.</p>
<hr>
<h3 id="notes">Notes<a hidden class="anchor" aria-hidden="true" href="#notes">#</a></h3>
<p>This project demonstrates:</p>
<ul>
<li>The <strong>sensitivity</strong> of orbital trajectories to small perturbations.</li>
<li>The usefulness of <strong>implicit integration</strong> methods for close approaches.</li>
<li>The practical application of the <strong>CR3BP</strong> in trajectory planning.</li>
</ul>
<hr>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://noahkleven.com/">Noah‚Äôs Engineering Blog</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
